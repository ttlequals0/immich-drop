<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - Immich Drop</title>
  <link rel="icon" type="image/png" href="/static/favicon.png" />
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="page-wrap page-wrap--wide">
    <div id="topBanner" class="banner hidden"></div>

    <header class="site-header">
      <h1>Admin</h1>
      <div class="header-actions">
        <a id="linkPublicUploader" href="/" class="btn hidden">Public uploader</a>
        <a href="/logout" id="btnLogout" class="btn">Logout</a>
        <button id="btnTheme" class="btn btn--icon" title="Toggle dark mode" aria-label="Toggle theme">
          <svg id="iconLight" class="hidden" fill="currentColor" viewBox="0 0 20 20" width="16" height="16">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414z" clip-rule="evenodd"/>
          </svg>
          <svg id="iconDark" fill="currentColor" viewBox="0 0 20 20" width="16" height="16">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
          </svg>
        </button>
        <button id="btnPing" class="btn">Test connection</button>
        <span id="pingStatus" class="text-sm text-secondary"></span>
      </div>
    </header>

    <!-- Create Upload Link -->
    <section class="card">
      <div class="card-header"><h2>Create Upload Link</h2></div>
      <div class="form-group">
        <label class="form-label">Target album (optional)</label>
        <div id="albumControls" class="space-y-sm">
          <div id="albumSelectWrap" class="hidden"><select id="albumSelect" class="input"></select></div>
          <div id="albumInputWrap" class="hidden">
            <input id="albumInput" placeholder="Album name (leave blank for none)" class="input" />
            <button id="btnCreateAlbum" class="btn mt-2">Create album</button>
          </div>
          <div id="albumHint" class="form-hint"></div>
        </div>
      </div>
      <div class="form-row form-row--3">
        <div><label class="form-label">Usage</label><select id="usage" class="input"><option value="1">One-time</option><option value="-1">Indefinite</option></select></div>
        <div><label class="form-label">Expires in days</label><input id="days" type="number" min="0" placeholder="No expiry" class="input" /></div>
        <div><label class="form-label">Password (optional)</label><input id="password" type="password" placeholder="Set a password" class="input" autocomplete="off" /><div class="form-hint">Recipients must enter this before uploading.</div></div>
      </div>
      <div class="mt-3"><button id="btnCreate" class="btn btn--primary">Create link</button></div>
      <div id="result" class="hidden mt-3">
        <div id="linkRow" class="flex gap-2" style="flex-wrap:wrap;"><input id="linkOut" class="input flex-1" readonly /><button id="btnCopy" type="button" class="btn">Copy</button></div>
        <div class="mt-2"><img id="qrImg" alt="QR" style="width:140px;height:140px;" /></div>
      </div>
    </section>

    <!-- Manage Links -->
    <section class="card">
      <div class="card-header">
        <h2>Manage Links</h2>
        <div class="flex gap-2 flex-wrap items-center">
          <input id="searchQ" placeholder="Search..." class="input" style="width:140px;" />
          <select id="sortSel" class="input" style="width:130px;"><option value="-created">Newest</option><option value="created">Oldest</option><option value="-expires">Expiry desc</option><option value="expires">Expiry asc</option><option value="name">Name A-Z</option><option value="-name">Name Z-A</option></select>
          <button id="btnRefresh" class="btn btn--sm">Refresh</button>
        </div>
      </div>
      <div style="overflow-x:auto;">
        <table class="data-table data-table--responsive">
          <thead><tr><th style="width:32px;"><input id="chkAll" type="checkbox"/></th><th>Name</th><th>Status</th><th>Uses</th><th>Expires</th><th>Album</th><th>Actions</th></tr></thead>
          <tbody id="invitesTBody"></tbody>
        </table>
      </div>
      <div class="flex justify-end gap-2 flex-wrap mt-3" style="padding-top:12px;border-top:1px solid var(--border);">
        <button id="btnDisableSel" class="btn btn--sm">Disable selected</button>
        <button id="btnEnableSel" class="btn btn--sm">Enable selected</button>
        <button id="btnDeleteSel" class="btn btn--sm btn--danger">Delete selected</button>
      </div>
    </section>

    <!-- Platform Cookies -->
    <section class="card">
      <div class="card-header"><h2>Platform Cookies</h2><button id="btnRefreshCookies" class="btn btn--sm">Refresh</button></div>
      <p class="text-sm text-secondary mb-3">Add cookies for authenticated social media downloads. Paste the raw cookie header from your browser DevTools (Network tab).</p>
      <div class="form-row" style="grid-template-columns:160px 1fr auto;align-items:end;">
        <div><label class="form-label">Platform</label><select id="cookiePlatform" class="input"><option value="">Select...</option></select></div>
        <div><label class="form-label">Cookie String</label><textarea id="cookieString" rows="2" placeholder="sessionid=abc123; csrftoken=xyz789; ..." class="input" style="font-family:var(--font-mono);font-size:0.8125rem;"></textarea></div>
        <div><button id="btnSaveCookie" class="btn btn--primary">Save</button></div>
      </div>
      <div id="cookieResult" class="banner hidden mt-3"></div>
      <div style="overflow-x:auto;" class="mt-3">
        <table class="data-table data-table--responsive">
          <thead><tr><th>Platform</th><th>Cookie Preview</th><th>Updated</th><th>Actions</th></tr></thead>
          <tbody id="cookiesTBody"></tbody>
        </table>
      </div>
    </section>

    <div class="text-xs text-tertiary" style="margin-bottom:12px;">If album listing or creation is forbidden by your token, specify a fixed album in the .env file as IMMICH_ALBUM_NAME.</div>
    <footer class="site-footer"><a id="version-link" href="https://github.com/ttlequals0/immich-drop" target="_blank" rel="noopener">immich-drop</a></footer>
  </div>

  <script src="/static/header.js"></script>
  <script src="/static/menu.js"></script>
</body>
</html>
